---
import { getCollection } from 'astro:content';
import BlogPostPage from '@/components/pages/blog/BlogPostPage.astro';
import { getPostSlug, isPostVisibleInProduction } from '@/lib/blog';

export async function getStaticPaths() {
  const allPosts = await getCollection('blog');
  const posts = allPosts.filter((post) => {
    if (!post.id.startsWith('es/')) return false;
    if (import.meta.env.PROD) return isPostVisibleInProduction(post);
    return true;
  });
  return posts.map((post) => ({
    params: { slug: getPostSlug(post.id) },
    props: { post },
  }));
}

const { post } = Astro.props;
---

<BlogPostPage lang="es" post={post} />
