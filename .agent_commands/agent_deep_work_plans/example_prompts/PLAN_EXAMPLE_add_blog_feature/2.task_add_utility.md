# Task 2: Add getRelatedPosts Utility Function

## Context

We need a utility function to find posts that share tags with a given post.

## Goal

Add `getRelatedPosts` function to `src/lib/blog.ts`.

## Instructions

1. **Add** the function to `src/lib/blog.ts`

2. **Implement** logic to:
   - Find posts with matching tags
   - Exclude the current post
   - Sort by number of matching tags (most relevant first)
   - Limit to specified count (default: 3)

3. **Add** TypeScript types

## Example Implementation

```typescript
/**
 * Get related posts based on matching tags
 */
export async function getRelatedPosts(
  currentPost: CollectionEntry<'blog'>,
  limit: number = 3
): Promise<CollectionEntry<'blog'>[]> {
  const allPosts = await getCollection('blog');
  const currentTags = currentPost.data.tags || [];
  
  if (currentTags.length === 0) {
    return [];
  }
  
  // Score posts by matching tags
  const scoredPosts = allPosts
    .filter(post => post.id !== currentPost.id)
    .map(post => {
      const postTags = post.data.tags || [];
      const matchingTags = postTags.filter(tag => 
        currentTags.includes(tag)
      ).length;
      return { post, score: matchingTags };
    })
    .filter(({ score }) => score > 0)
    .sort((a, b) => {
      // Sort by score, then by date
      if (b.score !== a.score) return b.score - a.score;
      return b.post.data.pubDate.valueOf() - a.post.data.pubDate.valueOf();
    });
  
  return scoredPosts.slice(0, limit).map(({ post }) => post);
}
```

## Acceptance Criteria

- [ ] Function added to src/lib/blog.ts
- [ ] Excludes current post from results
- [ ] Scores by matching tags
- [ ] Falls back to empty array if no tags
- [ ] TypeScript types correct

## Validation

```bash
npm run biome:check
npm run astro:check
```

## Execution Checklist

- [ ] Add getRelatedPosts function
- [ ] Add TypeScript types if needed
- [ ] Run validation
- [ ] Commit: `feat: add getRelatedPosts utility function`

---

## Completion Log

**Status:** ‚è≥ Pending
**Completed:** 
**Notes:**
