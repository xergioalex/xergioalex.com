# Task 7: Optimize Lambda Configuration

## 1. Context

Optimize Lambda memory, timeout, and other configuration settings for best performance.

**Location:** `serverless/services/botFlow/serverless.yml`

**Dependencies:** Tasks 1-6 completed

---

## 2. Goal

Configure Lambda for optimal cold start and execution performance.

---

## 3. Instructions

1. **Increase Lambda memory:**

   ```yaml
   functions:
     bot-flow:
       handler: src/functions/botFlow/handler.handler
       memorySize: 1024 # Increased from 512MB
       # More memory = faster CPU = faster cold starts
   ```

2. **Optimize timeout:**

   ```yaml
   timeout: 30 # Reduced from 240s (realistic timeout)
   ```

3. **Configure reserved concurrency (if needed):**

   ```yaml
   reservedConcurrency: 100 # Prevent throttling
   ```

4. **Enable Lambda Insights (optional):**

   ```yaml
   layers:
     - arn:aws:lambda:${aws:region}:580247275435:layer:LambdaInsightsExtension:14
   environment:
     LAMBDA_INSIGHTS_LOG_LEVEL: info
   ```

5. **Optimize environment variables:**
   - Remove unused variables
   - Keep only essential config
   - Use Parameter Store for secrets

6. **Consider provisioned concurrency for critical paths:**

   ```yaml
   provisionedConcurrency: 2 # For production, 0 cold starts
   ```

7. **Test configuration changes:**
   ```bash
   npm run sls:deploy:dev
   # Invoke function multiple times
   # Monitor CloudWatch metrics
   ```

---

## 4. Acceptance Criteria

- [ ] Lambda memory increased to 1024MB
- [ ] Timeout optimized to realistic value
- [ ] Reserved concurrency configured
- [ ] Environment variables optimized
- [ ] Cold start time reduced by 40%
- [ ] Execution time improved
- [ ] Cost impact calculated

---

## 5. Validation

```bash
# Deploy configuration
npm run sls:deploy:dev

# Test cold start improvement
aws lambda invoke --function-name botFlow-dev --log-type Tail output.json
cat output.json

# Check CloudWatch metrics for improvement
# Verify no increase in errors or timeouts
```

---

## 6. Completion & Log

**Status:** Not started
