# Task 4: Implement Advanced Code Splitting

## 1. Context

Further optimize bundle by splitting platform-specific code and implementing lazy loading.

**Location:** `src/functions/botFlow/`

**Dependencies:** Task 3 completed

---

## 2. Goal

Split botFlow code into platform-specific chunks to reduce initial bundle size.

---

## 3. Instructions

1. **Split platform handlers:**

   ```typescript
   // Before: all handlers loaded upfront
   import { SlackHandler } from './handlers/slack'

   // After: dynamic import based on platform
   const handler = await import(`./handlers/${platform}`)
   ```

2. **Create webpack entry points:**
   - Main entry: Core engine
   - Slack chunk
   - Discord chunk
   - Teams chunk
   - Telegram chunk

3. **Implement handler factory with lazy loading:**

   ```typescript
   async function getHandler(platform: ChatPlatformEType) {
     switch (platform) {
       case ChatPlatformEType.SLACK:
         return (await import('./handlers/slack')).SlackHandler
       // ... other platforms
     }
   }
   ```

4. **Update webpack config for multiple chunks**

5. **Test all platforms still work**

---

## 4. Acceptance Criteria

- [ ] Platform-specific code split into chunks
- [ ] Lazy loading implemented
- [ ] Initial bundle size further reduced
- [ ] All platforms functional
- [ ] No increase in cold start time

---

## 5. Validation

```bash
npm run test
npm run offline:botFlow
# Test each platform manually
codecheck
```

---

## 6. Completion & Log

**Status:** Not started
